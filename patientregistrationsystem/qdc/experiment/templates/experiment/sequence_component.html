{% extends "experiment/component_template.html" %}

{% block specific_header %}

    <script type="text/javascript">

        $(document).ready(function () {

            {% if form.number_of_mandatory_components.value == None %}
                $("#id_number_of_mandatory_components").prop('disabled', true);
                $("#mandatory_components").prop('checked', true);
            {% endif %}

            $("#mandatory_components").click(function () {
                var unlimited = $("#mandatory_components").is(":checked");
                $("#id_number_of_mandatory_components").prop('disabled', unlimited);
                $("#id_number_of_mandatory_components").prop('value', "");
            });

        });

    </script>

{% endblock %}

{% block breadcrumb %}

    {% if creating %}
        <li class="active">Nova sequência</li>
    {% else %}
        <li class="active"> Sequência: {{ component_form.identification.value }} </li>
    {% endif %}

{% endblock %}

{% block component_label %}
    <label class="control-label">Sequência </label>
{% endblock %}

{% block component_add_new %}
    <li role="presentation"><a role="menuitem" tabindex="-1" href="/experiment/{{ experiment.id }}/sequence/{{ sequence.id }}/new_component/task"><< Nova sequência >></a></li>
{% endblock %}

{% block component_button_label %}
    Nova sequência
{% endblock %}

{% block extra_fields %}
    <div class="container span6 offset3 well ">
        <div class="row">
            <div class="col-xs-6 col-sm-10">
                <div class="form-group">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>Componente</th>
                            <th>Tipo</th>
                            <th>Ordem</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for configuration in configuration_list %}
                            <tr>
                                <td><a data-toggle="tooltip" data-placement="left" title="Editar" href="/experiment/component_configuration/{% if component_configuration_id_list %}{{ component_configuration_id_list }}-{% endif %}{{ configuration.id }}">{{ configuration.component.identification }}</a></td>
                                <td>
                                    {{ configuration.component.component_type }}
                                </td>
                                <td>
                                    {% ifnotequal configuration configuration_list.last %}
                                        <a class="btn glyphicon glyphicon-arrow-down" href="/experiment/component/edit/{{ sequence.id }}/sequence/{{ configuration.order }}/{{ configuration.order|add:"1" }}/"></a>
                                    {% endifnotequal %}
                                    {% ifnotequal configuration configuration_list.first %}
                                        <a class="btn glyphicon glyphicon-arrow-up" href="/experiment/component/edit/{{ sequence.id }}/sequence/{{ configuration.order }}/{{ configuration.order|add:"-1" }}/"></a>
                                    {% endifnotequal %}
                                </td>
                            </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>

                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle {% if creating %} disabled{% endif %}" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                        Inserir componente à sequência
                        <span class="caret"></span>
                    </button>
                    {% if updating %}
                        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                            <li role="presentation"><a role="menuitem" tabindex="-1" class="{{ icon_class.task }}" href="/experiment/{{ experiment.id }}/sequence/{{ sequence.id }}/new_component/task"> Tarefa</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" class="{{ icon_class.stimulus }}" href="/experiment/{{ experiment.id }}/sequence/{{ sequence.id }}/new_component/stimulus"> Estímulo</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" class="{{ icon_class.pause }}" href="/experiment/{{ experiment.id }}/sequence/{{ sequence.id }}/new_component/pause"> Pausa</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" class="{{ icon_class.questionnaire }}" href="/experiment/{{ experiment.id }}/sequence/{{ sequence.id }}/new_component/questionnaire"> Questionário</a></li>
                            <li role="presentation"><a role="menuitem" tabindex="-1" class="{{ icon_class.sequence }}" href="/experiment/{{ experiment.id }}/sequence/{{ sequence.id }}/new_component/sequence"> Sequência</a></li>
                        </ul>
                    {% endif %}
                </div>
                </br>
                {% if not workflow %}
                    <div class="row">
                        <div class="col-xs-6 col-sm-6">
                            <div class="checkbox">
                                <label>
                                    <input id="has_random_components" {% if form.has_random_components.value == True %} checked {% endif %} name="has_random_components" type="checkbox"> Sequência aleatória
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6 col-sm-6">
                            <div class="checkbox">
                                <label>
                                    <input id="mandatory_components" type="checkbox"> Todos os componentes são obrigatórios
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6 col-sm-1"></div>
                        <div class="col-xs-6 col-sm-2">
                            <div class="form-group">
                                {{ form.number_of_mandatory_components }}
                            </div>
                        </div>
                        <div class="col-xs-6 col-sm-6">
                            Quantidade de componentes obrigatórios
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
